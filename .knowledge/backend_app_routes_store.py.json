{"is_source_file": true, "format": "Python", "description": "This file defines Flask route endpoints for an audiobook store API, including browsing, purchasing, user libraries, and playback progress management. It sets up multiple Flask blueprints with associated routes, request schemas, and database interactions.", "external_files": [".schemas", "../models", "flask", "flask.views", "flask_smorest", "sqlalchemy", "datetime"], "external_methods": ["flask.request", "flask.views.MethodView", "flask_smorest.Blueprint", "flask_smorest.abort", "sqlalchemy.func", "datetime.datetime.utcnow", "flask.current_app"], "published": ["register_routes"], "classes": [{"name": "StoreList", "description": "Handles browsing available audiobooks in the store."}, {"name": "PurchaseAudiobook", "description": "Handles the creation of audiobook purchase transactions."}, {"name": "UserLibrary", "description": "Allows users to retrieve their purchased audiobooks."}, {"name": "PlaybackProgressView", "description": "Manages getting and updating playback positions for audiobooks."}], "methods": [{"name": "get(self)", "description": "Retrieve the list of all available audiobooks or a user's library or playback progress, depending on class.", "scope": "StoreList", "scopeKind": "class"}, {"name": "post(self, purchase_data)", "description": "Create a new purchase record for an audiobook.", "scope": "PurchaseAudiobook", "scopeKind": "class"}, {"name": "get(self, user_id)", "description": "Retrieve a user's purchased audiobooks.", "scope": "UserLibrary", "scopeKind": "class"}, {"name": "get(self, user_id, audiobook_id)", "description": "Retrieve playback progress for a user's audiobook.", "scope": "PlaybackProgressView", "scopeKind": "class"}, {"name": "put(self, data, user_id, audiobook_id)", "description": "Update or create playback progress for a user's audiobook.", "scope": "PlaybackProgressView", "scopeKind": "class"}, {"name": "register_routes(api)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["Audiobook.query.all()", "Purchase.query.filter_by()", "db.session.add()", "db.session.commit()", "Purchase.query.filter_by().first()", "Audiobook.query.filter_by().first()", "PlaybackProgress.query.filter_by().first()", "PlaybackProgress.query.filter_by().first()", "db.session.add()", "db.session.commit()"], "search-terms": ["audiobook store routes", "purchase endpoint", "user library retrieval", "playback progress management", "blueprint registration"], "state": 2, "file_id": 7, "knowledge_revision": 15, "git_revision": "", "ctags": [{"_type": "tag", "name": "PlaybackProgressView", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^class PlaybackProgressView(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "PurchaseAudiobook", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^class PurchaseAudiobook(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StoreList", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^class StoreList(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserLibrary", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^class UserLibrary(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^blp = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "blp_library", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^blp_library = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "blp_playback", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^blp_playback = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^    def get(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "StoreList", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^    def get(self, user_id):$/", "language": "Python", "kind": "member", "signature": "(self, user_id)", "scope": "UserLibrary", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^    def get(self, user_id, audiobook_id):$/", "language": "Python", "kind": "member", "signature": "(self, user_id, audiobook_id)", "scope": "PlaybackProgressView", "scopeKind": "class"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^    def post(self, purchase_data):$/", "language": "Python", "kind": "member", "signature": "(self, purchase_data)", "scope": "PurchaseAudiobook", "scopeKind": "class"}, {"_type": "tag", "name": "put", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^    def put(self, data, user_id, audiobook_id):$/", "language": "Python", "kind": "member", "signature": "(self, data, user_id, audiobook_id)", "scope": "PlaybackProgressView", "scopeKind": "class"}, {"_type": "tag", "name": "register_routes", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^def register_routes(api):$/", "language": "Python", "kind": "function", "signature": "(api)"}, {"_type": "tag", "name": "store_blp", "path": "/home/kavia/workspace/code-generation/audiobook-library-55ac5558/backend/app/routes/store.py", "pattern": "/^    from .store import blp as store_blp, blp_library, blp_playback$/", "file": true, "language": "Python", "kind": "unknown", "scope": "register_routes", "scopeKind": "function", "nameref": "unknown:blp"}], "hash": "fb3ce22f906d988417a47c5cea08cb40", "format-version": 4, "code-base-name": "backend", "filename": "backend/app/routes/store.py", "fields": [{"name": "blp = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp_library = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp_playback = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"15": ""}]}